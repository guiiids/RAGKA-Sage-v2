<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Feedback Analytics Dashboard — Agilent Style</title>

  <!-- Roboto & Roboto Condensed (Agilent-like typographic system) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">

  <!-- Chart.js for simple charts (neutral styling) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    /* =========================
       Agilent-inspired design tokens
       ========================= */
    :root {
      --ag-blue: #0085d5;         /* Primary */
      --ag-dark-blue: #00426a;    
      --ag-med-blue: #2281c4;
      --ag-green: #3c7356;
      --ag-text: #202020;         /* Primary text */
      --ag-text-2: #888b8d;       /* Secondary text */
      --ag-bg: #ffffff;           /* Primary background */
      --ag-bg-2: #f4f3f1;         /* Secondary background */
      --ag-bg-3: #efefef;         /* Light gray */
      --ag-border: #d0d0ce;
      --ag-radius: 12px;
      --container: 1240px;        /* Grid width in style guide */
    }

    html, body {
      height: 100%;
      background: var(--ag-bg);
      color: var(--ag-text);
      font-family: 'Roboto', Arial, Helvetica, sans-serif;
      line-height: 1.45;
    }

    .container {
      max-width: var(--container);
      margin: 0 auto;
      padding: 0 12px;
    }

    /* =========================
       Header
       ========================= */
    .site-header {
      background: var(--ag-bg);
      border-bottom: 1px solid var(--ag-border);
    }
    .site-header .bar {
      height: 4px;
      background: var(--ag-blue);
    }
    .title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 0;
      gap: 16px;
    }
    h1 {
      font-family: 'Roboto Condensed', Arial, Helvetica, sans-serif;
      font-size: 24px;
      letter-spacing: 0.2px;
      margin: 0;
    }
    .subtitle {
      color: var(--ag-text-2);
      font-size: 14px;
      margin-top: 4px;
    }
    .meta {
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--ag-text-2);
      font-size: 12px;
      white-space: nowrap;
    }
    .meta .dot {
      width: 6px; height: 6px; border-radius: 50%; background: var(--ag-blue);
      display: inline-block; margin-right: 6px;
    }

    /* =========================
       Controls (subtle)
       ========================= */
    .controls {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .btn {
      background: var(--ag-blue);
      color: #fff;
      border: 0;
      padding: 8px 12px;
      font-size: 12px;
      font-weight: 500;
      text-transform: uppercase;
      border-radius: 0; /* square look */
      cursor: pointer;
    }
    .btn.secondary { background: var(--ag-bg-3); color: var(--ag-text); }
    .btn.text { background: transparent; color: var(--ag-blue); }

    .input {
      height: 34px;
      padding: 0 8px;
      border: 1px solid var(--ag-border);
      width: 220px; max-width: 100%;
      font-size: 14px;
      border-radius: 0;
      background: #fff;
    }

    /* =========================
       Grid + Cards
       ========================= */
    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
    @media (max-width: 1100px) { .grid-4 { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 640px) { .grid-4, .grid-2 { grid-template-columns: 1fr; } }

    .card {
      background: var(--ag-bg);
      border: 1px solid var(--ag-border);
      border-radius: var(--ag-radius);
      padding: 16px;
    }
    .card h2 {
      margin: 0 0 8px 0;
      font-size: 16px;
    }

    /* KPI tiles — compact, no rainbow */
    .kpi { display: flex; flex-direction: column; gap: 8px; }
    .kpi .label { color: var(--ag-text-2); font-size: 12px; }
    .kpi .value { font-family: 'Roboto Condensed', Arial, Helvetica, sans-serif; font-size: 28px; }
    .kpi .note { color: var(--ag-text-2); font-size: 11px; }

    /* Charts */
    .chart { height: 260px; }

    /* Section */
    .section { margin: 20px 0; }
    .section-title {
      font-size: 16px; margin: 0 0 12px 0; padding-bottom: 8px;
      border-bottom: 1px solid var(--ag-border);
    }

    /* Table */
    .table-wrap { overflow-x: auto; }
    table.data { border-collapse: collapse; width: 100%; }
    table.data th {
      text-align: left; font-weight: 400; font-size: 12px; color: var(--ag-text-2);
      padding: 8px 16px 8px 0; border-bottom: 1px solid var(--ag-border);
      white-space: nowrap; text-transform: uppercase; letter-spacing: .2px;
    }
    table.data td {
      padding: 10px 16px 10px 0; font-size: 14px; vertical-align: top; color: var(--ag-text);
      border-bottom: 1px solid #eee;
    }
    table.data tr:hover td { background: #fafafa; }

    .truncate { max-width: 340px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

    /* Badges (low-chroma) */
    .badge { font-size: 11px; padding: 4px 8px; border-radius: 999px; border: 1px solid var(--ag-border); display: inline-block; }
    .badge.pos { color: var(--ag-green); border-color: rgba(60,115,86,.4); }
    .badge.neg { color: #9c2e2e; border-color: rgba(156,46,46,.35); }
    .badge.tag { color: var(--ag-text-2); }

    /* Footer note */
    .footnote { color: var(--ag-text-2); font-size: 12px; margin-top: 10px; }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="bar"></div>
    <div class="container">
      <div class="title-row">
        <div>
          <h1>Feedback Analytics Dashboard</h1>
          <div class="subtitle">Comprehensive analysis of user feedback data</div>
        </div>
        <div class="meta" id="generatedAt"><span class="dot"></span>Generated: —</div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Controls -->
    <div class="section" style="display:flex; justify-content: space-between; align-items: center; gap:12px; flex-wrap: wrap;">
      <div class="controls">
        <button class="btn" id="refreshBtn">Refresh</button>
        <button class="btn secondary" id="exportBtn">Export CSV</button>
        <button class="btn text" id="denseBtn">Dense mode</button>
      </div>
      <input class="input" id="search-input" placeholder="Search feedback…" />
    </div>

    <!-- KPIs -->
    <section class="section">
      <div class="grid-4">
        <div class="card kpi">
          <div class="label">Total Queries</div>
          <div class="value" id="kpi-total-queries">470</div>
          <div class="note">Unique user questions</div>
        </div>
        <div class="card kpi">
          <div class="label">Total Feedback</div>
          <div class="value" id="kpi-total-feedback">564</div>
          <div class="note">All feedback entries</div>
        </div>
        <div class="card kpi">
          <div class="label">Positive Feedback</div>
          <div class="value" id="kpi-positive">50.7%</div>
          <div class="note"><span id="kpi-positive-detail">286 of 564</span></div>
        </div>
        <div class="card kpi">
          <div class="label">Avg. Response Time</div>
          <div class="value" id="kpi-avg-time">842.3s</div>
          <div class="note">Min 0.2s · Med 457.3s · Max 3584.9s</div>
        </div>
      </div>
    </section>

    <!-- Charts -->
    <section class="section">
      <div class="grid-2">
        <div class="card">
          <h2 class="section-title">Requests Per Hour (Last 6 Hours)</h2>
          <canvas id="requestsPerHourChart" class="chart"></canvas>
          <div class="footnote">Neutral visual weight; single brand tone only.</div>
        </div>
        <div class="card">
          <h2 class="section-title">Word Cloud of Queries and Tags</h2>
          <canvas id="wordCloudCanvas" class="chart" aria-label="word cloud"></canvas>
          <div class="footnote">Placeholder canvas; plug your existing word-cloud renderer.</div>
        </div>
      </div>
    </section>

    <!-- Table -->
    <section class="section">
      <div class="card">
        <div style="display:flex; align-items:center; justify-content: space-between; gap:12px; margin-bottom: 8px;">
          <h2 class="section-title" style="border:0; padding:0; margin:0;">All Feedback</h2>
          <div class="subtitle">Total: <span id="total-count">0</span> entries</div>
        </div>
        <div class="table-wrap">
          <table class="data" id="feedback-table">
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>User Query</th>
                <th>Response</th>
                <th>Status</th>
                <th>Tags</th>
                <th>Comments</th>
              </tr>
            </thead>
            <tbody id="feedback-table-body">
              <!-- Sample rows; replace with your data binding -->
              <tr>
                <td>2025-08-07 10:49:47</td>
                <td class="truncate" title="openlab 2.6 GC 6890N compatibility">openlab 2.6 GC 6890N compatibility</td>
                <td class="truncate" title="For a 5 µL syringe used on a GC system…">For a 5 µL syringe used on a GC system…</td>
                <td><span class="badge pos">Positive</span></td>
                <td><span class="badge tag">helpful</span></td>
                <td class="truncate" title="—">—</td>
              </tr>
              <tr>
                <td>2025-08-07 09:47:15</td>
                <td class="truncate" title="Please find the PM scope of work for…">Please find the PM scope of work for…</td>
                <td class="truncate" title="The PM scope of work for the Aria…">The PM scope of work for the Aria…</td>
                <td><span class="badge neg">Negative</span></td>
                <td><span class="badge tag">incorrect</span></td>
                <td class="truncate" title="Need linked source">Need linked source</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <div class="footnote">Typography, spacing, and color follow the Agilent website look-and-feel: Roboto / Roboto Condensed, #0085d5 primary, restrained accents, compact density.</div>
    <br />
  </main>

  <script>
    // Timestamp
    (function annotateTime(){
      const el = document.getElementById('generatedAt');
      const d = new Date();
      const pad = (n) => String(n).padStart(2,'0');
      const ts = `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
      el.innerHTML = `<span class="dot"></span>Generated: ${ts}`;
    })();

    // Dense mode toggle (tightens rows/cards a bit without breaking layout)
    document.getElementById('denseBtn').addEventListener('click', () => {
      document.body.classList.toggle('dense');
    });
    const denseStyles = document.createElement('style');
    denseStyles.innerHTML = `
      body.dense .card { padding: 12px; }
      body.dense .kpi .value { font-size: 24px; }
      body.dense table.data td { padding: 8px 12px 8px 0; }
    `;
    document.head.appendChild(denseStyles);

    // Simple search filter for table
    const search = document.getElementById('search-input');
    const tbody = document.getElementById('feedback-table-body');
    const total = document.getElementById('total-count');

    function reCount(){ total.textContent = tbody.querySelectorAll('tr').length; }
    reCount();

    search.addEventListener('input', () => {
      const q = search.value.toLowerCase().trim();
      const rows = tbody.querySelectorAll('tr');
      rows.forEach(r => {
        const t = r.textContent.toLowerCase();
        r.style.display = t.includes(q) ? '' : 'none';
      });
    });

    // Export CSV (very small helper over visible rows)
    document.getElementById('exportBtn').addEventListener('click', () => {
      const rows = [...document.querySelectorAll('#feedback-table tr')].map(tr => [...tr.children].map(td => '"'+td.textContent.replace(/"/g,'\"').trim()+'"').join(','));
      const blob = new Blob([rows.join('\n')], {type:'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'feedback_export.csv'; a.click();
      URL.revokeObjectURL(url);
    });

    // Simple chart with a single brand tone
    const ctx = document.getElementById('requestsPerHourChart');
    if (ctx) {
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['-5h','-4h','-3h','-2h','-1h','now'],
          datasets: [{
            data: [1,3,2,4,2,3],
            borderColor: getComputedStyle(document.documentElement).getPropertyValue('--ag-blue').trim(),
            pointRadius: 2,
            tension: 0.25,
            fill: false
          }]
        },
        options: {
          plugins: { legend: { display: false } },
          scales: {
            x: { grid: { color: 'rgba(0,0,0,0.05)' } },
            y: { grid: { color: 'rgba(0,0,0,0.05)' }, ticks: { precision: 0 } }
          }
        }
      });
    }

    // Word cloud placeholder (draw simple words so layout is demonstrable)
    const wc = document.getElementById('wordCloudCanvas');
    if (wc) {
      const ctx2 = wc.getContext('2d');
      const W = wc.width = wc.clientWidth;
      const H = wc.height = wc.clientHeight;
      ctx2.fillStyle = '#0000000d';
      ctx2.fillRect(0,0,W,H);
      const words = [
        ['helpful',42], ['incorrect',28], ['source',18], ['how',35], ['data',20], ['incomplete',14]
      ];
      words.forEach((w,i) => {
        const size = 14 + w[1] * 0.6;
        ctx2.font = `${size}px 'Roboto Condensed', 'Roboto', sans-serif`;
        ctx2.fillStyle = i % 2 ? '#3a3a3a' : '#5b5b5b';
        ctx2.fillText(w[0], 20 + (i%3)* (W/3 - 40), 40 + i*34 % (H-20));
      });
    }

    // Refresh stub
    document.getElementById('refreshBtn').addEventListener('click', () => {
      annotateTime && annotateTime();
    });
  </script>
</body>
</html>
